"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1870],{1870:($,b,s)=>{s.r(b),s.d(b,{RegisterPageModule:()=>K});var _=s(6814),t=s(95),l=s(6728),Z=s(3912),P=s(5861),I=s(7307);class y extends I.F{constructor(i,c,o,n,a,u,g,d){super(i,c,o,n,a,u,g),this.password=d}}var w=s(7299),e=s(6689),q=s(833),N=s(4340),Q=s(3733),A=s(9680),R=s(6593),U=s(2759),k=s(1734),F=s(5748);const C=["imagen"];function J(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function E(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"El nombre debe componerse s\xf3lo de letras"),e.qZA(),e.BQk())}function S(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"El nombre debe tener m\xe1s de tres letras"),e.qZA(),e.BQk())}function Y(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function x(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"El apellido debe componerse s\xf3lo de letras"),e.qZA(),e.BQk())}function M(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"El apellido debe tener m\xe1s de dos letras"),e.qZA(),e.BQk())}function B(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function z(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"El DNI debe ser un valor entre 0 y 99999999"),e.qZA(),e.BQk())}function O(r,i){if(1&r){const c=e.EpF();e.TgZ(0,"ion-item")(1,"img",21,22),e.NdJ("load",function(n){e.CHM(c);const a=e.oxw();return e.KtG(a.loadImg(n))}),e.qZA(),e.TgZ(3,"ion-fab",23)(4,"ion-fab-button",24),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.delFoto())}),e._UZ(5,"ion-icon",25),e.qZA()()()}if(2&r){const c=e.oxw();e.xp6(1),e.Q6J("src",c.fotoSrc,e.LSH)}}function L(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function G(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Formato de correo inv\xe1lido"),e.qZA(),e.BQk())}function H(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function D(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"La clave debe tener entre 4 y 15 car\xe1cteres"),e.qZA(),e.BQk())}function V(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Campo requerido"),e.qZA(),e.BQk())}function j(r,i){1&r&&(e.ynx(0),e.TgZ(1,"p",20),e._uU(2,"Las claves no coinciden"),e.qZA(),e.BQk())}const W=[{path:"",component:(()=>{var r;class i{constructor(o,n,a,u,g,d,m,f,p){this.interceptor=o,this.auth=n,this.toastService=a,this.router=u,this.fotosService=g,this.sanitizer=d,this.usuariosService=m,this.push=f,this.qr=p,this.passwordMatchingValidatior=h=>{const v=h.get("password"),T=h.get("confirmPassword");return(null==v?void 0:v.value)===(null==T?void 0:T.value)?null:{notmatched:!0}},this.fotoSrc=""}get nombre(){return this.regForm.get("nombre")}get apellido(){return this.regForm.get("apellido")}get dni(){return this.regForm.get("dni")}get foto(){return this.regForm.get("foto")}get email(){return this.regForm.get("email")}get password(){return this.regForm.get("password")}get confirmPassword(){return this.regForm.get("confirmPassword")}ngOnInit(){this.regForm=new t.cw({nombre:new t.NI("",{validators:[t.kI.required,t.kI.minLength(3),t.kI.pattern("[A-Za-z\xc0-\xff ]+")],updateOn:"change"}),apellido:new t.NI("",{validators:[t.kI.required,t.kI.minLength(2),t.kI.pattern("[A-Za-z\xc0-\xff ]+")],updateOn:"change"}),dni:new t.NI("",{validators:[t.kI.required,t.kI.min(0),t.kI.maxLength(99999999)],updateOn:"change"}),foto:new t.NI("",{validators:[t.kI.required],updateOn:"change"}),email:new t.NI("",{validators:[t.kI.required,t.kI.email],updateOn:"change"}),password:new t.NI("",{validators:[t.kI.required,t.kI.minLength(4),t.kI.maxLength(15)],updateOn:"change"}),confirmPassword:new t.NI("",{validators:[t.kI.required],updateOn:"change"})},{validators:this.passwordMatchingValidatior}),this.usuariosService.currentUserState.subscribe(o=>{var n,a,u;o&&(null===(n=this.regForm.controls.nombre)||void 0===n||n.setValue(o.name),null===(a=this.regForm.controls.apellido)||void 0===a||a.setValue(o.lastName),null===(u=this.regForm.controls.dni)||void 0===u||u.setValue(o.dni))})}save(){var o=this;return(0,P.Z)(function*(){if(o.regForm.valid){var n,a,u,g,d,m;let f=new y("",null===(n=o.nombre)||void 0===n?void 0:n.value.toLowerCase().trim(),null===(a=o.apellido)||void 0===a?void 0:a.value.toLowerCase().trim(),null===(u=o.dni)||void 0===u?void 0:u.value,null===(g=o.foto)||void 0===g?void 0:g.value,null===(d=o.email)||void 0===d?void 0:d.value,w.t.Cliente,null===(m=o.password)||void 0===m?void 0:m.value);o.auth.addUser(f,f.password).then(p=>{p?(o.toastService.openSuccessToast("Usuario guardado exitosamente","top"),o.limpiarFormulario(),setTimeout(()=>{o.router.navigateByUrl("login")},1500)):o.toastService.openErrorToast("No se pudo guardar el usuario","top")}).catch(p=>{o.toastService.openErrorToast(p,"top")})}})()}test(){this.pushToAdmins("mailcito@mail.com")}pushToAdmins(o){return(0,P.Z)(function*(){try{console.log({title:"Cliente registrado: "+o,description:"Se aguarda su aprobaci\xf3n"})}catch(n){console.log("error push to admin",n)}})()}updFoto(){this.fotosService.takePhoto().then(o=>{this.fotoSrc=this.sanitizer.bypassSecurityTrustUrl(`${"data:image/"+o.format+";base64,"} ${o.base64String}`)})}delFoto(){var o;this.fotoSrc="",null===(o=this.regForm.controls.foto)||void 0===o||o.reset()}limpiarFormulario(){this.fotoSrc="",this.regForm.reset()}loadImg(o){var n,a;const u=null===(n=this.imagen)||void 0===n?void 0:n.nativeElement;var g=u.naturalWidth,d=u.naturalHeight,m=document.createElement("canvas");g>d?g>350&&(d*=350/g,g=350):d>250&&(g*=250/d,d=250),m.width=g,m.height=d,m.getContext("2d").drawImage(u,0,0,g,d);var v=m.toDataURL();null===(a=this.regForm.controls.foto)||void 0===a||a.setValue(v)}leerQr(){this.qr.leerQr()}}return(r=i).\u0275fac=function(o){return new(o||r)(e.Y36(q._),e.Y36(N.D),e.Y36(Q.k),e.Y36(Z.F0),e.Y36(A.H),e.Y36(R.H7),e.Y36(U.J),e.Y36(k.Z),e.Y36(F.x))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-register"]],viewQuery:function(o,n){if(1&o&&e.Gf(C,5),2&o){let a;e.iGM(a=e.CRH())&&(n.imagen=a.first)}},decls:50,vars:19,consts:[[3,"translucent"],["slot","start"],["default-href","#"],[1,"pt-3"],[3,"fullscreen"],[1,"bg"],[2,"display","flex","justify-content","center"],["src","../../../assets/images/icon.png",2,"max-width","40%","margin-top","5%"],["id","regForm",3,"formGroup","ngSubmit"],["color","primary","labelPlacement","floating","label","Nombre","formControlName","nombre","type","text","required",""],[4,"ngIf"],["color","primary","labelPlacement","floating","label","Apellido","formControlName","apellido","type","text","required",""],["color","primary","labelPlacement","floating","label","DNI","formControlName","dni","type","number","required",""],["color","tertiary",3,"click"],["name","camera-sharp","size","large"],["color","primary","labelPlacement","floating","label","Correo","formControlName","email","type","email","required",""],["color","primary","labelPlacement","floating","label","Clave","formControlName","password","type","password","maxlength","15","required",""],["color","primary","labelPlacement","floating","label","Repetir clave","formControlName","confirmPassword","type","password","maxlength","15","required",""],["expand","block","size","large","color","warning",3,"click"],["expand","block","type","submit","size","large",3,"disabled"],[1,"error"],["alt","foto",3,"src","load"],["imagen",""],["vertical","top","horizontal","end",1,"pe-1"],["size","small","color","danger",1,"mt-0",3,"click"],["name","close-outline"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title",3),e._uU(5,"Alta de usuario"),e.qZA()()(),e.TgZ(6,"ion-content",4)(7,"div",5)(8,"div",6),e._UZ(9,"img",7),e.qZA(),e.TgZ(10,"ion-card")(11,"ion-card-content")(12,"form",8),e.NdJ("ngSubmit",function(){return n.save()}),e.TgZ(13,"ion-list")(14,"ion-item"),e._UZ(15,"ion-input",9),e.qZA(),e.YNc(16,J,3,0,"ng-container",10),e.YNc(17,E,3,0,"ng-container",10),e.YNc(18,S,3,0,"ng-container",10),e.TgZ(19,"ion-item"),e._UZ(20,"ion-input",11),e.qZA(),e.YNc(21,Y,3,0,"ng-container",10),e.YNc(22,x,3,0,"ng-container",10),e.YNc(23,M,3,0,"ng-container",10),e.TgZ(24,"ion-item"),e._UZ(25,"ion-input",12),e.qZA(),e.YNc(26,B,3,0,"ng-container",10),e.YNc(27,z,3,0,"ng-container",10),e.TgZ(28,"ion-item")(29,"ion-label"),e._uU(30,"Foto"),e.qZA(),e.TgZ(31,"ion-button",13),e.NdJ("click",function(){return n.updFoto()}),e._UZ(32,"ion-icon",14),e.qZA()(),e.YNc(33,O,6,1,"ion-item",10),e.TgZ(34,"ion-item"),e._UZ(35,"ion-input",15),e.qZA(),e.YNc(36,L,3,0,"ng-container",10),e.YNc(37,G,3,0,"ng-container",10),e.TgZ(38,"ion-item"),e._UZ(39,"ion-input",16),e.qZA(),e.YNc(40,H,3,0,"ng-container",10),e.YNc(41,D,3,0,"ng-container",10),e.TgZ(42,"ion-item"),e._UZ(43,"ion-input",17),e.qZA(),e.YNc(44,V,3,0,"ng-container",10),e.YNc(45,j,3,0,"ng-container",10),e.qZA(),e.TgZ(46,"ion-button",18),e.NdJ("click",function(){return n.leerQr()}),e._uU(47,"Leer DNI"),e.qZA(),e.TgZ(48,"ion-button",19),e._uU(49,"Guardar"),e.qZA()()()()()()),2&o&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(6),e.Q6J("formGroup",n.regForm),e.xp6(4),e.Q6J("ngIf",(null==n.nombre?null:n.nombre.hasError("required"))&&(null==n.nombre?null:n.nombre.touched)),e.xp6(1),e.Q6J("ngIf",null==n.nombre?null:n.nombre.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",null==n.nombre?null:n.nombre.hasError("minlength")),e.xp6(3),e.Q6J("ngIf",(null==n.apellido?null:n.apellido.hasError("required"))&&(null==n.apellido?null:n.apellido.touched)),e.xp6(1),e.Q6J("ngIf",null==n.apellido?null:n.apellido.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",null==n.apellido?null:n.apellido.hasError("minlength")),e.xp6(3),e.Q6J("ngIf",(null==n.dni?null:n.dni.hasError("required"))&&(null==n.dni?null:n.dni.touched)),e.xp6(1),e.Q6J("ngIf",(null==n.dni?null:n.dni.hasError("min"))||(null==n.dni?null:n.dni.hasError("max"))),e.xp6(6),e.Q6J("ngIf",n.fotoSrc),e.xp6(3),e.Q6J("ngIf",(null==n.email?null:n.email.hasError("required"))&&(null==n.email?null:n.email.touched)),e.xp6(1),e.Q6J("ngIf",null==n.email?null:n.email.hasError("email")),e.xp6(3),e.Q6J("ngIf",(null==n.password?null:n.password.hasError("required"))&&(null==n.password?null:n.password.touched)),e.xp6(1),e.Q6J("ngIf",(null==n.password?null:n.password.hasError("minlength"))||(null==n.password?null:n.password.hasError("maxlength"))),e.xp6(3),e.Q6J("ngIf",(null==n.confirmPassword?null:n.confirmPassword.hasError("required"))&&(null==n.confirmPassword?null:n.confirmPassword.touched)),e.xp6(1),e.Q6J("ngIf",null==n.regForm?null:n.regForm.hasError("passwordMatchingValidatior")),e.xp6(3),e.Q6J("disabled",n.regForm.invalid))},dependencies:[_.O5,t._Y,t.JJ,t.JL,t.Q7,t.nD,l.YG,l.Sm,l.PM,l.FN,l.W2,l.IJ,l.W4,l.Gu,l.gu,l.pK,l.Ie,l.Q$,l.q_,l.wd,l.sr,l.as,l.j9,l.oU,t.sg,t.u],styles:[".error[_ngcontent-%COMP%]{color:#eb445a;font-size:12px;margin-left:1rem}hr[_ngcontent-%COMP%]{opacity:1;border-width:.2rem;color:#3880ff}img[_ngcontent-%COMP%]{border-radius:1rem}ion-title[_ngcontent-%COMP%]{font-family:Borel}.bg[_ngcontent-%COMP%]{background-image:url(bg.a3f5591984efe0ee.png);background-repeat:no-repeat;background-size:100% 100%;background-color:#ccc;height:100%;width:100%}"]}),i})()}];let X=(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[Z.Bz.forChild(W),Z.Bz]}),i})(),K=(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[_.ez,t.u5,l.Pc,X,t.UX]}),i})()}}]);