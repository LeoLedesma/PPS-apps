"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1424],{1424:(Q,p,l)=>{l.r(p),l.d(p,{CosasLindasPageModule:()=>w});var u=l(6814),x=l(95),i=l(6728),v=l(3912),Z=l(15),_=l(3035),h=l(4454),t=l(6689),b=l(9680),T=l(6593),L=l(4340),P=l(833),C=l(9739);let S=(()=>{var e;class c{constructor(o){this.fotosService=o,this.fotos=[]}ngOnDestroy(){var o;null===(o=this.fotosSub)||void 0===o||o.unsubscribe()}ngOnInit(){this.traerObjetos()}traerObjetos(){this.fotosSub=this.fotosService.getFotos(h.P.Linda).subscribe(o=>{this.fotos=o,this.createChart()})}mostrarFecha(o){return o.toDate().toLocaleString()}createChart(){let o=[],a=[];this.fotos.forEach(s=>{o.push(s.email+" - "+this.mostrarFecha(s.fecha));let r=s.votos.filter(g=>"up"===g.tipo).length,d=s.votos.filter(g=>"down"===g.tipo).length;a.push(r+d)}),C.kL.defaults.font.size=16,this.chart=new C.kL("MyChart",{type:"pie",data:{labels:o,datasets:[{label:"Votos",data:a}]},options:{plugins:{legend:{display:!0,position:"bottom"},tooltip:{enabled:!0,position:"nearest",external:function(s){console.log(s.chart.data)}}}}})}}return(e=c).\u0275fac=function(o){return new(o||e)(t.Y36(b.H))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-g-torta"]],decls:5,vars:1,consts:[[1,"chart-container","my-3"],[1,"text-center","text-dark","display-6","mt-4",2,"font-size","1.5rem","font-weight","300"],["id","MyChart"]],template:function(o,a){1&o&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Votos de cosas lindas"),t.qZA(),t.TgZ(3,"canvas",2),t._uU(4),t.qZA()()),2&o&&(t.xp6(4),t.Oqu(a.chart))}}),c})();const A=["imagen"];function y(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"ion-list")(1,"div",22)(2,"div",23)(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"h2"),t._uU(6),t.qZA()(),t.TgZ(7,"div",24),t._UZ(8,"img",25),t.qZA(),t.TgZ(9,"div",26)(10,"div",27)(11,"div",28)(12,"ion-icon",29),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.votoArriba(s))}),t.qZA(),t.TgZ(13,"ion-label",30),t._uU(14),t.qZA()(),t.TgZ(15,"div",28)(16,"ion-icon",31),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.votoAbajo(s))}),t.qZA(),t.TgZ(17,"ion-label"),t._uU(18),t.qZA()()()()()()}if(2&e){const n=c.$implicit,o=t.oxw(2);t.xp6(4),t.Oqu(o.mostrarFecha(n.fecha)),t.xp6(2),t.Oqu(n.email),t.xp6(2),t.s9C("alt",n.cosa),t.s9C("src",n.base64,t.LSH),t.xp6(4),t.Q6J("name",o.getVotoTipo(n,"up")?"thumbs-up":"thumbs-up-outline"),t.xp6(1),t.Q6J("ariaSetSize",10),t.xp6(1),t.Oqu(o.getCantidadVotos(n,"up")),t.xp6(2),t.Q6J("name",o.getVotoTipo(n,"down")?"thumbs-down":"thumbs-down-outline"),t.xp6(2),t.Oqu(o.getCantidadVotos(n,"down"))}}function k(e,c){1&e&&(t.TgZ(0,"div")(1,"ion-list",32)(2,"h1"),t._uU(3,"No hay fotos cargadas"),t.qZA()()())}function M(e,c){if(1&e&&(t.TgZ(0,"ion-card",18)(1,"ion-card-header")(2,"ion-card-title")(3,"h1",19),t._uU(4,"Fotos de cosas lindas"),t.qZA()(),t._UZ(5,"br"),t.qZA(),t.TgZ(6,"ion-card-content"),t.YNc(7,y,19,9,"ion-list",20),t.YNc(8,k,4,0,"div",21),t.qZA()()),2&e){const n=t.oxw();t.xp6(7),t.Q6J("ngForOf",n.cosas),t.xp6(1),t.Q6J("ngIf",0==n.cosas.length)}}function O(e,c){1&e&&(t.TgZ(0,"ion-content"),t._UZ(1,"app-g-torta"),t.qZA())}const z=function(){return[0,.6,1]},F=[{path:"",component:(()=>{var e;class c{constructor(o,a,s,r){this.fotosService=o,this.sanitizer=a,this.auth=s,this.interceptor=r,this.cosas=[]}ngOnDestroy(){var o;null===(o=this.cosasSub)||void 0===o||o.unsubscribe()}loadImg(o){var a;const s=null===(a=this.imagen)||void 0===a?void 0:a.nativeElement;var r=s.naturalWidth,d=s.naturalHeight,g=document.createElement("canvas");r>d?r>350&&(d*=350/r,r=350):d>250&&(r*=250/d,d=250),g.width=r,g.height=d,g.getContext("2d").drawImage(s,0,0,r,d);var q=g.toDataURL();let V=new _.T("",h.P.Linda,q,this.auth.userLogged.email,Z.EK.now());this.fotosService.uploadFoto(V)}ngOnInit(){this.interceptor.updateOverlayState(!0),this.cosasSub=this.fotosService.getFotos(h.P.Linda).subscribe(o=>{this.interceptor.updateOverlayState(!1),this.cosas=o})}subirFoto(){this.fotosService.takePhoto().then(o=>{this.fotoSrc=this.sanitizer.bypassSecurityTrustUrl(`${"data:image/"+o.format+";base64,"} ${o.base64String}`)})}mostrarFecha(o){return o.toDate().toLocaleString()}votar(o,a){this.getVoto(o)?this.getVotoTipo(o,a)?this.fotosService.revertirVoto(o,this.auth.userLogged.email):this.fotosService.deleteVoto(o,this.auth.userLogged.email):this.fotosService.addVoto(o,this.auth.userLogged.email,a)}votoArriba(o){this.votar(o,"up")}votoAbajo(o){this.votar(o,"down")}getVotoTipo(o,a){return o.votos.some(s=>s.email==this.auth.userLogged.email&&s.tipo==a)}getVoto(o){return o.votos.some(a=>a.email==this.auth.userLogged.email)}getCantidadVotos(o,a){return o.votos.filter(s=>s.tipo==a).length}}return(e=c).\u0275fac=function(o){return new(o||e)(t.Y36(b.H),t.Y36(T.H7),t.Y36(L.D),t.Y36(P._))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-cosas-lindas"]],viewQuery:function(o,a){if(1&o&&t.Gf(A,5),2&o){let s;t.iGM(s=t.CRH())&&(a.imagen=s.first)}},decls:24,vars:7,consts:[[3,"translucent"],["slot","start"],["default-href","#"],[3,"fullscreen"],["collapse","condense"],["size","large"],["class","mt-1 mb-5",4,"ngIf"],["trigger","open-modal",3,"initialBreakpoint","breakpoints"],["modal",""],["slot","fixed","vertical","bottom","horizontal","start"],["color","success","size","large",3,"click"],["name","camera-sharp","size","large"],["slot","fixed","vertical","bottom","horizontal","end"],["id","open-modal","color","success"],["name","pie-chart","size","large"],[2,"display","none"],["alt","foto",3,"src","load"],["imagen",""],[1,"mt-1","mb-5"],[1,"text-light","text-center"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row","border-bottom","border-1","border-light"],[1,"fecha","text-center"],[1,"d-flex","justify-content-center",2,"max-height","15rem","overflow","scroll"],[3,"alt","src"],[1,"row","py-2","m-0",2,"background-color","black"],[1,"d-flex","justify-content-around","align-items-center"],[1,"d-flex","flex-column"],["color","success","size","large",3,"name","click"],[3,"ariaSetSize"],["color","danger","size","large",3,"name","click"],[1,"text-center"]],template:function(o,a){1&o&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Cosas lindas"),t.qZA()()(),t.TgZ(6,"ion-content",3)(7,"ion-header",4)(8,"ion-toolbar")(9,"ion-title",5),t._uU(10,"Cosas lindas"),t.qZA()()(),t.YNc(11,M,9,2,"ion-card",6),t.TgZ(12,"ion-modal",7,8),t.YNc(14,O,2,0,"ng-template"),t.qZA(),t.TgZ(15,"ion-fab",9)(16,"ion-fab-button",10),t.NdJ("click",function(){return a.subirFoto()}),t._UZ(17,"ion-icon",11),t.qZA()(),t.TgZ(18,"ion-fab",12)(19,"ion-fab-button",13),t._UZ(20,"ion-icon",14),t.qZA()()(),t.TgZ(21,"div",15)(22,"img",16,17),t.NdJ("load",function(r){return a.loadImg(r)}),t.qZA()()),2&o&&(t.Q6J("translucent",!0),t.xp6(6),t.Q6J("fullscreen",!0),t.xp6(5),t.Q6J("ngIf",0!=a.cosas.length),t.xp6(1),t.Q6J("initialBreakpoint",.6)("breakpoints",t.DdM(6,z)),t.xp6(10),t.Q6J("src",a.fotoSrc,t.LSH))},dependencies:[u.sg,u.O5,i.Sm,i.PM,i.FN,i.Zi,i.Dq,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Q$,i.q_,i.wd,i.sr,i.ki,i.oU,S],styles:[".miBtn[_ngcontent-%COMP%]{height:100px;font-size:20px}ion-fab-button[_ngcontent-%COMP%]{height:80px;width:80px}ion-content[_ngcontent-%COMP%]{background-image:url(bg.a3f5591984efe0ee.png);background-repeat:no-repeat;background-size:100% 100%;background-color:#ccc;height:100%;width:100%}#background-content[_ngcontent-%COMP%]{background:transparent}.fecha[_ngcontent-%COMP%]{color:#fff}ion-card-content[_ngcontent-%COMP%]{background:darkgreen}ion-card-header[_ngcontent-%COMP%]{background:darkgreen}ion-list[_ngcontent-%COMP%]{background:darkgreen}ion-label[_ngcontent-%COMP%]{font-size:25px}"]}),c})()}];let U=(()=>{var e;class c{}return(e=c).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[v.Bz.forChild(F),v.Bz]}),c})(),w=(()=>{var e;class c{}return(e=c).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,x.u5,i.Pc,U]}),c})()}}]);